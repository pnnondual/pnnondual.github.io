<!doctype html>
<meta charset="utf-8">
<title>Reset NJPourDigital</title>
<style>
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,sans-serif;padding:2rem;line-height:1.5}
  .ok{color:#0a7d00}.muted{color:#666}
</style>
<h1>Resetting site…</h1>
<p class="muted">This clears old Service Workers and caches, then reloads the homepage.</p>
<pre id="log"></pre>
<script>
(async () => {
  const log = (m,ok=false)=>{document.getElementById('log').textContent += (ok?'✔ ':'• ') + m + '\n'};
  try {
    if ('serviceWorker' in navigator) {
      const regs = await navigator.serviceWorker.getRegistrations();
      for (const r of regs) { await r.unregister(); }
      log(`Unregistered ${regs.length} service worker(s)`, true);
    } else {
      log('Service workers not supported (nothing to unregister).', true);
    }
    if (window.caches) {
      const keys = await caches.keys();
      for (const k of keys) { await caches.delete(k); }
      log(`Deleted ${keys.length} cache storages`, true);
    }
    // Give the browser a beat to drop control, then hard reload root
    setTimeout(()=>location.replace('/?fresh=' + Date.now()), 600);
  } catch(e) {
    log('Error: ' + (e && e.message ? e.message : e), false);
  }
})();
</script>
